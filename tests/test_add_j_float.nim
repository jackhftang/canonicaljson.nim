import unittest
import ../src/canonicaljson/canonify_float

suite "canonify":

  test "canonify":
    check: canonify(1/3)   == "0.3333333333333333"
    check: canonify(1/4)   == "0.25"
    check: canonify(1/5)   == "0.2"
    check: canonify(1/6)   == "0.16666666666666666"
    check: canonify(1/7)   == "0.14285714285714285"
    check: canonify(1/9)   == "0.1111111111111111"
    check: canonify(1/11)  == "0.09090909090909091"
    check: canonify(1/13)  == "0.07692307692307693"
    check: canonify(2/3)   == "0.6666666666666666"
    check: canonify(100/7) == "14.285714285714286"
    check: canonify(-1/3) == "-0.3333333333333333"
    check: canonify(-2/3) == "-0.6666666666666666"
    
    check: canonify(1e23) == "1e+23"
    

  test "1e+xx":
    check: canonify(10000000000000000000000f64) == "1e+22"
    check: canonify(1000000000000000000000f64) == "1e+21"
    check: canonify(100000000000000000000f64) == "100000000000000000000"
    check: canonify(10000000000000000000f64) == "10000000000000000000"
    check: canonify(1000000000000000000f64) == "1000000000000000000"
    check: canonify(100000000000000000f64) == "100000000000000000"
    check: canonify(10000000000000000f64) == "10000000000000000"
    check: canonify(1000000000000000f64) == "1000000000000000"
    check: canonify(100000000000000f64) == "100000000000000"
    check: canonify(10000000000000f64) == "10000000000000"
    check: canonify(1000000000000f64) == "1000000000000"
    check: canonify(100000000000f64) == "100000000000"
    check: canonify(10000000000f64) == "10000000000"
    check: canonify(1000000000f64) == "1000000000"
    check: canonify(100000000f64) == "100000000"
    check: canonify(10000000f64) == "10000000"
    check: canonify(1000000f64) == "1000000"
    check: canonify(100000f64) == "100000"
    check: canonify(10000f64) == "10000"
    check: canonify(1000f64) == "1000"
    check: canonify(100f64) == "100"
    check: canonify(10f64) == "10"
    check: canonify(1f64) == "1"
    check: canonify(0.1) == "0.1"
    check: canonify(0.01) == "0.01"
    check: canonify(0.001) == "0.001"
    check: canonify(0.0001) == "0.0001"
    check: canonify(0.00001) == "0.00001"
    check: canonify(0.000001) == "0.000001"
    check: canonify(0.0000001) == "1e-7"
    check: canonify(0.00000001) == "1e-8"
    check: canonify(0.000000001) == "1e-9"
    check: canonify(0.0000000001) == "1e-10"


  test "2e+xx":
    check: canonify(20000000000000000000000f64) == "2e+22"
    check: canonify(2000000000000000000000f64) == "2e+21"
    check: canonify(200000000000000000000f64) == "200000000000000000000"
    check: canonify(20000000000000000000f64) == "20000000000000000000"
    check: canonify(2000000000000000000f64) == "2000000000000000000"
    check: canonify(200000000000000000f64) == "200000000000000000"
    check: canonify(20000000000000000f64) == "20000000000000000"
    check: canonify(2000000000000000f64) == "2000000000000000"
    check: canonify(200000000000000f64) == "200000000000000"
    check: canonify(20000000000000f64) == "20000000000000"
    check: canonify(2000000000000f64) == "2000000000000"
    check: canonify(200000000000f64) == "200000000000"
    check: canonify(20000000000f64) == "20000000000"
    check: canonify(2000000000f64) == "2000000000"
    check: canonify(200000000f64) == "200000000"
    check: canonify(20000000f64) == "20000000"
    check: canonify(2000000f64) == "2000000"
    check: canonify(200000f64) == "200000"
    check: canonify(20000f64) == "20000"
    check: canonify(2000f64) == "2000"
    check: canonify(200f64) == "200"
    check: canonify(20f64) == "20"
    check: canonify(2f64) == "2"
    check: canonify(0.2) == "0.2"
    check: canonify(0.02) == "0.02"
    check: canonify(0.002) == "0.002"
    check: canonify(0.0002) == "0.0002"
    check: canonify(0.00002) == "0.00002"
    check: canonify(0.000002) == "0.000002"
    check: canonify(0.0000002) == "2e-7"
    check: canonify(0.00000002) == "2e-8"
    check: canonify(0.000000002) == "2e-9"
    check: canonify(0.0000000002) == "2e-10"

  test "2e+xx/3":
    check: canonify(2e22/3) == "6.666666666666667e+21"
    check: canonify(2e21/3) == "666666666666666600000"
    check: canonify(2e20/3) == "66666666666666660000"
    check: canonify(2e19/3) == "6666666666666667000"
    check: canonify(2e18/3) == "666666666666666600"
    check: canonify(2e17/3) == "66666666666666664"
    check: canonify(2e16/3) == "6666666666666667"
    check: canonify(2e15/3) == "666666666666666.6"
    check: canonify(2e14/3) == "66666666666666.664"
    check: canonify(2e13/3) == "6666666666666.667"
    check: canonify(2e12/3) == "666666666666.6666"
    check: canonify(2e11/3) == "66666666666.666664"
    check: canonify(2e10/3) == "6666666666.666667"
    check: canonify(2e9/3) == "666666666.6666666"
    check: canonify(2e8/3) == "66666666.666666664"
    check: canonify(2e7/3) == "6666666.666666667"
    check: canonify(2e6/3) == "666666.6666666666"
    check: canonify(2e5/3) == "66666.66666666667"
    check: canonify(2e4/3) == "6666.666666666667"
    check: canonify(2e3/3) == "666.6666666666666"
    check: canonify(2e2/3) == "66.66666666666667"
    check: canonify(2e1/3) == "6.666666666666667"
    check: canonify(2/3) == "0.6666666666666666"
    check: canonify(2e-1/3) == "0.06666666666666667"
    check: canonify(2e-2/3) == "0.006666666666666667"
    check: canonify(2e-3/3) == "0.0006666666666666666"
    check: canonify(2e-4/3) == "0.00006666666666666667"
    check: canonify(2e-5/3) == "0.0000066666666666666675"
    check: canonify(2e-6/3) == "6.666666666666666e-7"
    check: canonify(2e-7/3) == "6.666666666666667e-8"
    check: canonify(2e-8/3) == "6.666666666666667e-9"
    check: canonify(2e-9/3) == "6.666666666666667e-10"
    check: canonify(2e-10/3) == "6.666666666666667e-11"





